
# Correct way to handle StorageObj and return proper string output path
def compute_scores_for_df(...):
    ...
    # Save results to blob
    storage_obj = save_evaluation_results_to_blob(df_acc, filename=blob_path)

    # Extract only string path to avoid JSON serialization error
    output_path = ""
    if isinstance(storage_obj, StorageObj):
        # Option 1: If you want just the blob path (preferred)
        output_path = storage_obj.storagePath if hasattr(storage_obj, 'storagePath') else storage_obj.message
        
        # Option 2: If your team expects a string in 'message' (less precise)
        # output_path = storage_obj.message  # Make sure to spell it correctly
    elif isinstance(storage_obj, dict) and "storagePath" in storage_obj:
        output_path = storage_obj["storagePath"]
    else:
        output_path = str(storage_obj)  # fallback for unexpected object types

    print("The output path is", output_path)

    return {
        "outputDirectory": output_path,
        "results": df_acc.to_dict(orient="records")
    }
